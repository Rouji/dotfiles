#!/usr/bin/env python3
import sys
import re
import subprocess
import os.path

urls = sys.argv[1:]
conf = []
with open(os.path.expanduser("~/.config/openurl.conf")) as f:
    for line in f:
        conf.append(line.split())

for u in urls:
    for c in conf:
        reg = c[0]
        args = c[1:]
        if re.search(reg, u) is not None:
            subprocess.Popen(['notify-send', 'opening with ' + args[0], u])
            subprocess.Popen([a.replace('$url$', u) for a in args])
            break
